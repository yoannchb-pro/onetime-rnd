{"version":3,"file":"index.js","sources":["../index.ts"],"sourcesContent":["type Options = {\r\n  to?: number;\r\n  from?: number;\r\n  float?: number;\r\n  repeat?: boolean;\r\n  shuffleOnRepeat?: boolean;\r\n  autoRefresh?: boolean;\r\n  exclusive?: boolean;\r\n};\r\n\r\nconst MAX_ITERATION = 10;\r\n\r\nclass OneTimeRnd {\r\n  private rnd: number[] = [];\r\n  private back: number[] = [];\r\n  private options: Options = {\r\n    from: 0,\r\n    to: 100,\r\n    float: 0,\r\n  };\r\n\r\n  private endedFn: Function;\r\n\r\n  constructor(options: Options = {}) {\r\n    Object.assign(this.options, options);\r\n\r\n    this.generateRange();\r\n    this.shuffle();\r\n  }\r\n\r\n  shuffle() {\r\n    this.rnd.sort(() => Math.random() - 0.5);\r\n  }\r\n\r\n  private generateRange() {\r\n    const ex = this.options.exclusive ? 0 : 1;\r\n\r\n    for (let i = this.options.from; i < this.options.to + ex; ++i) {\r\n      //Generate float\r\n      if (this.options.float) {\r\n        let j = 0;\r\n        let iterations = 0;\r\n        while (j < this.options.float) {\r\n          const nb = i + Math.random();\r\n          if (!this.rnd.includes(nb) || iterations > MAX_ITERATION) {\r\n            iterations = 0;\r\n            this.rnd.push(nb);\r\n            ++j;\r\n          }\r\n          ++iterations;\r\n        }\r\n      } else {\r\n        this.rnd.push(i);\r\n      }\r\n    }\r\n  }\r\n\r\n  onEnd(fn: Function) {\r\n    this.endedFn = fn;\r\n  }\r\n\r\n  refresh() {\r\n    this.generateRange();\r\n    this.shuffle();\r\n  }\r\n\r\n  next() {\r\n    const nb = this.rnd.shift();\r\n    if (this.options.repeat && !this.options.autoRefresh) this.back.push(nb);\r\n\r\n    if (this.rnd.length === 0) {\r\n      if (this.options.repeat && !this.options.autoRefresh) {\r\n        this.rnd = [...this.back];\r\n        this.back = [];\r\n        if (this.options.shuffleOnRepeat) {\r\n          this.shuffle();\r\n        }\r\n      }\r\n\r\n      if (this.options.autoRefresh) {\r\n        this.generateRange();\r\n        this.shuffle();\r\n      }\r\n\r\n      if (this.endedFn) {\r\n        this.endedFn();\r\n      }\r\n    }\r\n\r\n    return nb;\r\n  }\r\n}\r\n\r\nexport default OneTimeRnd;\r\n"],"names":[],"mappings":"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"}